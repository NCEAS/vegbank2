INSERT INTO  observation(
    plot_id,
    project_id,
    authorobscode,
    obsstartdate,
    obsenddate,
    dateaccuracy,
    dateentered,
    covermethod_id,
    coverdispersion,
    autotaxoncover,
    stratummethod_id,
    methodnarrative,
    taxonobservationarea,
    stemsizelimit,
    stemobservationarea,
    stemsamplemethod,
    originaldata,
    effortlevel,
    plotvalidationlevel,
    floristicquality,
    bryophytequality,
    lichenquality,
    observationnarrative,
    landscapenarrative,
    homogeneity,
    phenologicaspect,
    representativeness,
    standmaturity,
    successionalstatus,
    numberoftaxa,
    basalarea,
    hydrologicregime,
    soilmoistureregime,
    soildrainage,
    watersalinity,
    waterdepth,
    shoredistance,
    soildepth,
    organicdepth,
    soiltaxon_id,
    soiltaxonsrc,
    percentbedrock,
    percentrockgravel,
    percentwood,
    percentlitter,
    percentbaresoil,
    percentwater,
    percentother,
    nameother,
    treeht,
    shrubht,
    fieldht,
    nonvascularht,
    submergedht,
    treecover,
    shrubcover,
    fieldcover,
    nonvascularcover,
    floatingcover,
    submergedcover,
    dominantstratum,
    growthform1type,
    growthform2type,
    growthform3type,
    growthform1cover,
    growthform2cover,
    growthform3cover,
    totalcover,
    notesPublic,
    notesMgt,
    revisions,
    emb_observation,
    hasobservationsynonym
)
SELECT 
    CAST(SUBSTRING(pl_code, 4, LENGTH(pl_code) - 3) AS INT) AS plot_id,
    CAST(SUBSTRING(pj_code, 4, LENGTH(pj_code) - 3) AS INT) AS project_id,
    authorobscode,
    obsstartdate,
    obsenddate,
    dateaccuracy,
    dateentered,
    CAST(SUBSTRING(cm_code, 4, LENGTH(cm_code) - 3) AS INT) AS covermethod_id,
    coverdispersion,
    autotaxoncover,
    CAST(SUBSTRING(sm_code, 4, LENGTH(sm_code) - 3) AS INT) AS stratummethod_id,
    methodnarrative,
    taxonobservationarea,
    stemsizelimit,
    stemobservationarea,
    stemsamplemethod,
    originaldata,
    effortlevel,
    plotvalidationlevel,
    floristicquality,
    bryophytequality,
    lichenquality,
    observationnarrative,
    landscapenarrative,
    homogeneity,
    phenologicaspect,
    representativeness,
    standmaturity,
    successionalstatus,
    numberoftaxa,
    basalarea,
    hydrologicregime,
    soilmoistureregime,
    soildrainage,
    watersalinity,
    waterdepth,
    shoredistance,
    soildepth,
    organicdepth,
    CAST(SUBSTRING(st_code, 4, LENGTH(st_code) - 3) AS INT) AS soiltaxon_id,
    soiltaxonsrc,
    percentbedrock,
    percentrockgravel,
    percentwood,
    percentlitter,
    percentbaresoil,
    percentwater,
    percentother,
    nameother,
    treeht,
    shrubht,
    fieldht,
    nonvascularht,
    submergedht,
    treecover,
    shrubcover,
    fieldcover,
    nonvascularcover,
    floatingcover,
    submergedcover,
    dominantstratum,
    growthform1type,
    growthform2type,
    growthform3type,
    growthform1cover,
    growthform2cover,
    growthform3cover,
    totalcover,
    ob_notes_public,
    ob_notes_mgt,
    ob_revisions,
    emb_observation,
    hasobservationsynonym
FROM observation_temp
RETURNING observation_id, 'ob.' || observation_id AS ob_code, authorobscode;