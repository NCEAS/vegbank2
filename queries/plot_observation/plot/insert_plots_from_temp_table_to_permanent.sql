INSERT INTO plot 
(
    authorplotcode,
    reference_id,
    reallatitude,
    reallongitude,
    locationaccuracy,
    confidentialitystatus,
    confidentialityreason,
    latitude,
    longitude,
    authore,
    authorn,
    authorzone,
    authordatum,
    authorlocation,
    locationnarrative,
    plotrationalenarrative,
    azimuth,
    dsgpoly,
    shape,
    area,
    standsize,
    placementmethod,
    permanence,
    layoutnarrative,
    elevation,
    elevationaccuracy,
    elevationrange,
    slopeaspect,
    minslopeaspect,
    maxslopeaspect,
    slopegradient,
    minslopegradient,
    maxslopegradient,
    topoposition,
    landform,
    surficialdeposits,
    rocktype,
    stateprovince,
    country,
    dateentered,
    submitter_surname,
    submitter_givenname,
    submitter_email,
    notespublic,
    notesmgt,
    revisions
)
SELECT 
    authorplotcode,
    CAST(SUBSTRING(rf_code, 4, LENGTH(rf_code) - 3) AS INT) AS reference_id,
    reallatitude,
    reallongitude,
    locationaccuracy,
    confidentialitystatus,
    confidentialityreason,
    latitude,
    longitude,
    authore,
    authorn,
    authorzone,
    authordatum,
    authorlocation,
    locationnarrative,
    plotrationalenarrative,
    azimuth,
    dsgpoly,
    shape,
    area,
    standsize,
    placementmethod,
    permanence,
    layoutnarrative,
    elevation,
    elevationaccuracy,
    elevationrange,
    slopeaspect,
    minslopeaspect,
    maxslopeaspect,
    slopegradient,
    minslopegradient,
    maxslopegradient,
    topoposition,
    landform,
    surficialdeposits,
    rocktype,
    stateprovince,
    country,
    dateentered,
    submitter_surname,
    submitter_givenname,
    submitter_email,
    pl_notes_public,
    pl_notes_mgt,
    pl_revisions
FROM plot_temp
RETURNING plot_id, 'pl.' || plot_id AS pl_code, authorplotcode;